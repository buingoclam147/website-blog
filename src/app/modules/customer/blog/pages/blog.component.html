<ng-container [ngSwitch]="state">
  <ng-container *ngSwitchCase="1">
    <ng-template [ngTemplateOutlet]="addTpl"></ng-template>
  </ng-container>
  <ng-container *ngSwitchCase="2">
    <ng-template [ngTemplateOutlet]="preViewTpl"></ng-template>
  </ng-container>
</ng-container>

<ng-template #preViewTpl>
  <div class="preView">
    <div class=" dataView">
      <div class="individual d-flex justify-content-center align-items-center pt-4 mb-3">
        <div nz-row class="align-items-center">
          <div class="mx-2 d-flex align-items-center">
            <img class="avt" src="/assets/avt.png" alt="avt" nz-dropdown>
            <div class="textEspecially ms-2">{{valueNikname}}</div>
          </div>
          <div class="st-thanh">/</div>
          <div class="mx-2">
            <div>{{ dateNow |date:'dd/MM/yyyy'}}</div>
          </div>
          <div class="st-thanh">/</div>
          <div class="mx-2">
            <div class="textEspecially">{{onCategory}}</div>
          </div>
        </div>
        <div nz-row class="titleView d-flex align-item-center  justify-content-center mt-3 title-7">
          {{valueTitle}}
        </div>
      </div>
      <ng-template [ngTemplateOutlet]="ckTpl"></ng-template>
    </div>
    <div class="d-flex f-right ms-4">
      <button class="mx-2 btn-basic" (click)="view(1)">Chỉnh sửa</button>
      <button class="mx-2 btn-basic" (click)="routerDemo($event)">Đăng bài</button>
    </div>
  </div>
</ng-template>

<ng-template #addTpl>
  <div class="center pt-5 pb-6 mb-5">
    <div class="container-fluid ">
      <div nz-row [nzGutter]="{ xs: 8, sm: 16, md: 24, lg: 32 }" class="mb-5">
        <div nz-col class="gutter-row" [nzSpan]="12">
          <div class="inner-box">
            <app-input-basic placeholder="Tiêu đề bài viết" [(value)]="valueTitle"></app-input-basic>
          </div>
        </div>
        <div nz-col class="gutter-row" [nzSpan]="12">
          <div class="inner-box">
            <app-input-basic placeholder="Biệt danh của bạn" [(value)]="valueNikname"></app-input-basic>
          </div>
        </div>
        <div nz-col class="gutter-row" [nzSpan]="24">
          <ng-container *ngIf="lCategory$ |async as listCategory">
            <div class="inner-box mt-5">
              <nz-select nzShowSearch nzAllowClear [nzDropdownRender]="renderTemplate" nzPlaceHolder="Thể loại"
                [nzSize]="'large'" [ngModel]="onCategory" (ngModelChange)="onCategoryChange($event)">
                <nz-option *ngFor="let item of listOfItem" [nzLabel]="item" [nzValue]="item"></nz-option>
              </nz-select>
              <nz-alert *ngIf="errorMessage" class="err mt-3" nzType="error" nzMessage="Thể loại không được bỏ trống">
              </nz-alert>
            </div>
          </ng-container>
        </div>
      </div>
      <div class="bgr-box mb-3">
        <ng-template [ngTemplateOutlet]="ckTpl"></ng-template>
      </div>
      <div class="d-flex f-right ms-4">
        <button class="mx-2 btn-basic" (click)="view(2)">Xem</button>
        <button class="mx-2 btn-basic" (click)="addBgrBlog()">Thêm nền bài viết</button>
        <button class="mx-2 btn-basic" (click)="routerDemo($event)">Đăng bài</button>
      </div>
    </div>
  </div>

  <ng-template #renderTemplate>
    <nz-divider></nz-divider>
    <div class="container">
      <input type="text" nz-input #inputElement />
      <a class="add-item" (click)="addItem(inputElement)">
        <i nz-icon nzType="plus"></i>
        Thêm thể loại
      </a>
    </div>
  </ng-template>
</ng-template>

<nz-modal [(nzVisible)]="isVisible" nzTitle="Thông báo!" (nzOnCancel)="handleCancel()" (nzOnOk)="handleOk()"
  nzOkText="Đồng ý" nzCancelText="Hủy">
  <ng-container *nzModalContent>
    <p>Hiện tại thể loại của bạn hiện chưa có, bạn có chắc muốn thêm mới thể loại và đăng bài?</p>
  </ng-container>
</nz-modal>


<ng-template #ckTpl>
  <app-ckeditor-form [config]="state==2 ? { toolbar: [], language:''}: CONFIG_CK_FORM" [readonly]="state==2"
    [(data)]="data">
  </app-ckeditor-form>
</ng-template>

<nz-modal [(nzVisible)]="isVisibleBgr" nzTitle="Thêm ảnh nền cho bài viết" [nzFooter]="null"
  (nzOnCancel)="handleCancelBgr()">
  <ng-container *nzModalContent>
    <input type="file" id="file" class="displayN" #userPhoto (change)="onFileSelected($event)" name="image"
      autocomplete="off">
    <label class="btn-basic mx-2 " for="file" (click)="isVisibleBgr=false">Thoát</label>
    <label class="btn-basic mx-2 " for="file" *ngIf="!bgrUrl; else addImageTpl">Thêm ảnh</label>
    <ng-template #addImageTpl>
      <label class="btn-basic mx-2" for="file">Thay ảnh</label>
    </ng-template>
    
    <div class="cartBlog" *ngIf="bgrUrl">
      <hr width="472px" > 
      <div class="inner-box my-3 pointer">
        <div class="cart">
          <img [src]="bgrUrl" [alt]="bgrUrl">
          <div class="boxPersonal d-flex mb-2">
            <b class="d-flex">
              <ng-container *ngIf="onCategory; else notCategoryTpl ">{{onCategory}}</ng-container>
              <ng-template #notCategoryTpl>
                <b> Thể loại</b>
              </ng-template>
              <ng-container *ngIf="valueNikname; else notNiknameTpl">| {{valueNikname}}</ng-container>
              <ng-template #notNiknameTpl>
                <b>| Biệt danh</b>
              </ng-template>
            </b>
            <div class="left">{{dateNow |date:'dd/MM/yyyy'}}</div>
          </div>
          <ng-container *ngIf="valueTitle; else notTitleTpl">
            <h3>
              {{valueTitle}}
            </h3>
          </ng-container>
          <ng-template #notTitleTpl>
            <h3 class="title-4">Tên bài viết của bạn</h3>
          </ng-template>
        </div>
      </div>
    </div>
  </ng-container>
</nz-modal>